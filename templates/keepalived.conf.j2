! Configuration File for keepalived

global_defs {
	# VRRP params
	vrrp_skip_check_adv_addr
	vrrp_garp_interval 0
	vrrp_gna_interval 0

	# Don't run scripts configured to be run as root if any part of the path
	# is writable by a non-root user.
	enable_script_security

  # script_user keepalived_script

}

# Adds a script to be executed periodically. Its exit code will be
# recorded for all VRRP instances which are monitoring it.
vrrp_script chk_haproxy {
	script "/sbin/pidof haproxy"
	user root
	interval 5
	init_fail
}

# Include application configs
{% for item in keepalived_configs %}
include /etc/keepalived/conf.d/{{ item.name }}.conf
{% endfor %}
